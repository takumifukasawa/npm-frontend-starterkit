block ConfigBlock
  - title = page_name ? [page_name, site_name].join(' | ') : site_name

//- config/pug.jsonの中身を適宜override
block Variables
  -
    if(!meta) meta = {}
      
      var shareItems = [ 
      {
        type: 'hatena',
        href: hatena_share_link
      }, {
        type: 'facebook',
        href: facebook_share_link
      }, {
        type: 'twitter',
        href: twitter_share_link
      }
    ];
  -

block BeforeHTMLBlock
  | <?php
  |   require_once('./../../cgi/ProcessData.php');
  |   require_once('./../../cgi/FileUtil.php');
  |   $speech_data = ProcessData::get_speech_data('./../../config/speech.csv');
  |   $site_config = FileUtil::get_obj_from_json('./../../config/pug.json');
  |   $voice_archive_path = $site_config->voice_archive->path;
  | ?>


doctype html
html(lang="ja")
  head
    meta(charset="utf-8")
    
    block MetaBlock
    
      title= meta.title
      if meta.description
        meta(name="description", content=meta.description)
      if meta.keywords && meta.keywords.length
        meta(name="keywords", content=meta.keywords.join ? meta.keywords.join(', ') : meta.keywords)
      if meta.favicon_url
        link(rel="shortcut icon", href=meta.favicon_url, type="image/vnd.microsoft.icon")
        link(rel="icon", href=meta.favicon_url, type="image/vnd.microsoft.icon")

      //- IEで「互換モード」で表示されるのを防ぐための指定
      meta(http-equiv="X-UA-Compatible", content="IE=Edge")
        
      // smartphone meta
      meta(name="viewport", content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no")
      if meta.webclipicon_url
        meta(name="apple-mobile-web-app-capable", content='yes')
        meta(name="apple-mobile-web-app-status-bar-style", content=meta.ios_status_bar || 'default')
        link(rel="apple-touch-icon", href=meta.webclipicon_url)

      //- ogp
      if meta.facebook_app_id
        meta(property="fb:app_id", content=meta.facebook_app_id)
      if meta.url
        meta(property="og:url", content=meta.url)
      if meta.ogp_image_url
        meta(property="og:image", content=meta.ogp_image_url)
      meta(property="og:type", content=meta.ogp_type || "website")
      if meta.og_title
        meta(property="og:title", content=meta.og_title)
      if meta.site_name
        meta(property="og:site_name", content=meta.site_name)
      if meta.og_description
        meta(property="og:description", content=meta.og_description)
      meta(property="og:locale", content=meta.ogp_locale || "ja_JP")

      //- twitter card
      meta(property="twitter:card", content=(meta.ogp_image_url ? 'summary_large_image' : 'summary'))
      if meta.twitter_title
        meta(property="twitter:title", content=meta.twitter_title)
      if meta.twitter_description
        meta(property="twitter:description", content=meta.twitter_description)
      if meta.ogp_image_url
        meta(property="twitter:image", content=meta.ogp_image_url)

      if meta.url
        //- canonical url
        //- このページをはてぶ・シェアする際、使われるべきURLを明示する指定
        //- wwwやhttps、getパラメータなど、微妙に違うURLでアクセスされても、使われるURLをひとつに絞れる
        link(rel="canonical" href=meta.url)

    //- stylesheet
    block StylesheetBlock
      link(rel="stylesheet" href=base.css_dir + "style.css")

  body
    
    block BeforeContentBlock

    block ContentBlock

    script.
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-75253926-1', 'auto');
      ga('send', 'pageview');

    //- javascript
    block JavascriptBlock
      script(src=base.js_dir + "index.js")

